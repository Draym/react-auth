"use strict";(self.webpackChunkreact_auth=self.webpackChunkreact_auth||[]).push([[502],{692:function(t,n,e){e.d(n,{Z:function(){return p}});var r,o=e(3144),i=e(5671),a=e(717);!function(t){t[t.UNAUTHORIZED=0]="UNAUTHORIZED",t[t.SERVER_ERROR=1]="SERVER_ERROR",t[t.OTHER=2]="OTHER"}(r||(r={}));var s=function(){function t(){(0,i.Z)(this,t)}return(0,o.Z)(t,null,[{key:"stringifyParameters",value:function(t){if(null==t)return"";var n="";for(var e in t)""!==n&&(n+="&"),n+="".concat(e,"=").concat(t[e]);return n=""===n?n:"?"+n}},{key:"createUrl",value:function(t,n,e){return null!=t&&"/"!==t.slice(-1)&&(t+="/"),(t||"")+n+(e||"")}},{key:"handleHttpResult",value:function(t,n,e){console.log("[HTTP]",t),(t.redirected||302===t.status)&&console.log("[HTTP] redirection"),401===t.status?(console.log("[HTTP] need login"),e({error:"Unauthorized access.",type:r.UNAUTHORIZED})):t.text().then((function(o){if(200===t.status){var i=JSON.parse(o);n(i.data)}else{var a=JSON.parse(o);e({error:a.data.error,type:r.SERVER_ERROR})}}))}},{key:"httpURL",value:function(t,n,e,o,i,s,u){var c=this;if(a.Z.hasSession()){var l=a.Z.getSessionToken();l&&(o.Authorization=l)}var h=this.stringifyParameters(i),p=this.createUrl(n,e,h);console.log("[API_"+t+"]: "+p),fetch(p,{method:t,headers:o}).then((function(t){c.handleHttpResult(t,s,u)})).catch((function(t){console.log("[API][ERROR]--\x3e",t),u({error:JSON.stringify(t.error),type:r.OTHER})}))}},{key:"httpData",value:function(t,n,e,o,i,s,u){var c=this;if(a.Z.hasSession()){var l=a.Z.getSessionToken();l&&(o.Authorization=l)}var h=this.createUrl(n,e,null);console.log("[API_"+t+"]: "+h),fetch(h,{method:t,headers:o,body:i}).then((function(t){c.handleHttpResult(t,s,u)})).catch((function(t){console.log("[API][ERROR]--\x3e",t),u({error:t.error,type:r.OTHER})}))}},{key:"get",value:function(t,n,e,r,o){var i={"Access-Control-Allow-Origin":"*"};this.httpURL("GET",t,n,i,e,r,o)}},{key:"post",value:function(t,n,e,r,o){var i={"Content-Type":"application/json",Accept:"application/json"};this.httpData("POST",t,n,i,JSON.stringify(e),r,o)}},{key:"put",value:function(t,n,e,r,o){var i={"Content-Type":"application/json",Accept:"application/json"};this.httpData("PUT",t,n,i,JSON.stringify(e),r,o)}},{key:"delete",value:function(t,n,e,r,o){var i={"Content-Type":"application/json",Accept:"application/json"};this.httpData("DELETE",t,n,i,JSON.stringify(e),r,o)}}]),t}(),u="api/auth/login",c="api/auth/signup",l="api/user/get",h={NODE_ENV:"production",PUBLIC_URL:"/react-auth",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_ENDPOINT||null,p=(0,o.Z)((function t(){(0,i.Z)(this,t)}));p.auth={login:function(t){return new Promise((function(n,e){s.post(h,u,t,n,e)}))},signup:function(t){return new Promise((function(n,e){s.post(h,c,t,n,e)}))}},p.user={get:function(){return new Promise((function(t,n){s.get(h,l,null,t,n)}))}}},2502:function(t,n,e){e.r(n),e.d(n,{default:function(){return y}});var r=e(5671),o=e(3144),i=e(7326),a=e(136),s=e(8347),u=e(2791),c=e(9271),l=e(3360),h=e(184),p=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,r.Z)(this,e),n.apply(this,arguments)}return(0,o.Z)(e,[{key:"render",value:function(){return(0,h.jsx)("div",{className:"animated fadeIn pt-1 text-center",children:"Loading..."})}}]),e}(u.Component),f=e(1363),d=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,r.Z)(this,e),n.apply(this,arguments)}return(0,o.Z)(e,[{key:"render",value:function(){return(0,h.jsx)("nav",{className:"navbar flex-md-nowrap p-0 shadow",children:(0,h.jsxs)("span",{children:[(0,h.jsx)(f.G,{icon:["fas","home"]})," Home"]})})}}]),e}(u.Component),v=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,r.Z)(this,e),n.apply(this,arguments)}return(0,o.Z)(e,[{key:"render",value:function(){return(0,h.jsx)("footer",{className:"text-center",children:(0,h.jsx)("div",{className:"footer-content",children:(0,h.jsx)("div",{className:"container",children:(0,h.jsx)("div",{className:"row",children:(0,h.jsx)("div",{className:"col-lg-12",children:(0,h.jsxs)("span",{className:"ml-auto",children:[(0,h.jsxs)("a",{href:"https://github.com/Draym",target:"https://github.com/Draym",children:[(0,h.jsx)(f.G,{icon:["fab","github"]})," Github"]})," \xa9 2020. kevin.andres@epitech.eu"]})})})})})})}}]),e}(u.Component),g=e(717),m=e(692),R=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(t){var o;return(0,r.Z)(this,e),(o=n.call(this,t)).logout=function(){g.Z.clearSession(),o.props.history.push("/")},o.state={loading:!0,user:null},o.logout=o.logout.bind((0,i.Z)(o)),o}return(0,o.Z)(e,[{key:"componentDidMount",value:function(){var t=this;m.Z.user.get().then((function(n){t.setState({loading:!1,user:{id:n.id,email:n.email,username:n.username}})}))}},{key:"render",value:function(){return this.state.loading||null==this.state.user?(0,h.jsx)(p,{}):(0,h.jsxs)("div",{className:"content",children:[(0,h.jsx)(d,{}),(0,h.jsxs)("div",{className:"container-fluid mt-5",children:[(0,h.jsxs)("h2",{children:["Welcome to your personal home ",this.state.user.username]}),(0,h.jsx)(l.Z,{variant:"secondary",onClick:this.logout,children:"Logout"})]}),(0,h.jsx)(v,{})]})}}]),e}(u.Component),y=(0,c.EN)(R)}}]);
//# sourceMappingURL=502.8a8edc25.chunk.js.map