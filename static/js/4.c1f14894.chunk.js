(this["webpackJsonpreact-auth"]=this["webpackJsonpreact-auth"]||[]).push([[4],{105:function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var a,r=n(9),i=n(8),s=n(13);!function(t){t[t.UNAUTHORIZED=0]="UNAUTHORIZED",t[t.SERVER_ERROR=1]="SERVER_ERROR",t[t.OTHER=2]="OTHER"}(a||(a={}));var o=function(){function t(){Object(i.a)(this,t)}return Object(r.a)(t,null,[{key:"stringifyParameters",value:function(t){if(null==t)return"";var e="";for(var n in t)""!==e&&(e+="&"),e+="".concat(n,"=").concat(t[n]);return e=""===e?e:"?"+e}},{key:"createUrl",value:function(t,e,n){return null!=t&&"/"!==t.slice(-1)&&(t+="/"),(t||"")+e+(n||"")}},{key:"handleHttpResult",value:function(t,e,n){console.log("[HTTP]",t),(t.redirected||302===t.status)&&console.log("[HTTP] redirection"),401===t.status?(console.log("[HTTP] need login"),n({error:"Unauthorized access.",type:a.UNAUTHORIZED})):t.text().then((function(r){if(200===t.status){var i=JSON.parse(r);e(i.data)}else{var s=JSON.parse(r);n({error:s.data.error,type:a.SERVER_ERROR})}}))}},{key:"httpURL",value:function(t,e,n,r,i,o,u){var c=this;if(s.a.hasSession()){var l=s.a.getSessionToken();l&&(r.Authorization=l)}var h=this.stringifyParameters(i),f=this.createUrl(e,n,h);console.log("[API_"+t+"]: "+f),fetch(f,{method:t,headers:r}).then((function(t){c.handleHttpResult(t,o,u)})).catch((function(t){console.log("[API][ERROR]--\x3e",t),u({error:JSON.stringify(t.error),type:a.OTHER})}))}},{key:"httpData",value:function(t,e,n,r,i,o,u){var c=this;if(s.a.hasSession()){var l=s.a.getSessionToken();l&&(r.Authorization=l)}var h=this.createUrl(e,n,null);console.log("[API_"+t+"]: "+h),fetch(h,{method:t,headers:r,body:i}).then((function(t){c.handleHttpResult(t,o,u)})).catch((function(t){console.log("[API][ERROR]--\x3e",t),u({error:t.error,type:a.OTHER})}))}},{key:"get",value:function(t,e,n,a,r){var i={"Access-Control-Allow-Origin":"*"};this.httpURL("GET",t,e,i,n,a,r)}},{key:"post",value:function(t,e,n,a,r){var i={"Content-Type":"application/json",Accept:"application/json"};this.httpData("POST",t,e,i,JSON.stringify(n),a,r)}},{key:"put",value:function(t,e,n,a,r){var i={"Content-Type":"application/json",Accept:"application/json"};this.httpData("PUT",t,e,i,JSON.stringify(n),a,r)}},{key:"delete",value:function(t,e,n,a,r){var i={"Content-Type":"application/json",Accept:"application/json"};this.httpData("DELETE",t,e,i,JSON.stringify(n),a,r)}}]),t}(),u="api/auth/login",c="api/auth/login/quick-login/eth",l="api/auth/login/quick-login/eth/get-nonce",h="api/auth/signup",f="api/auth/signup/eth-linked",d="api/user/get",p=Object({NODE_ENV:"production",PUBLIC_URL:"/react-auth",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_ENDPOINT||null,m=Object(r.a)((function t(){Object(i.a)(this,t)}));m.auth={login:function(t){return new Promise((function(e,n){o.post(p,u,t,e,n)}))},quickLogin:{ethLogin:function(t){return new Promise((function(e,n){o.post(p,c,t,e,n)}))},ethGetNonce:function(t){return new Promise((function(e,n){o.get(p,l,t,e,n)}))}},signup:function(t){return new Promise((function(e,n){o.post(p,h,t,e,n)}))},signupWithEth:function(t){return new Promise((function(e,n){o.post(p,f,t,e,n)}))}},m.user={get:function(){return new Promise((function(t,e){o.get(p,d,null,t,e)}))}}},123:function(t,e,n){},155:function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var a=n(106),r=n(8),i=n(9),s=n(23),o=n(20),u=n(21),c=n(69),l=n.n(c),h=n(0),f=n(122),d=n(572),p="data:image/png;base64,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",m=(n(123),n(95)),b=n(3),g=function(t){Object(o.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).onClick=a.onClick.bind(Object(s.a)(a)),a}return Object(i.a)(n,[{key:"onClick",value:function(){var t=Object(a.a)(l.a.mark((function t(e){var n=this;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.isMetamaskConnected();case 2:t.sent&&m.a.loadMetamask().then((function(){n.props.callback()}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"render",value:function(){return Object(b.jsxs)(f.a,{className:"metamask-btn",onClick:this.onClick,children:[Object(b.jsx)(d.a,{className:"metamask-icon",src:p}),Object(b.jsx)("span",{className:"metamask-btn-text",children:this.props.text})]})}}]),n}(h.Component)},162:function(t,e){},164:function(t,e){},165:function(t,e){},171:function(t,e){},182:function(t,e){},183:function(t,e){},191:function(t,e){},192:function(t,e){},201:function(t,e){},202:function(t,e){},243:function(t,e){},244:function(t,e){},249:function(t,e){},251:function(t,e){},273:function(t,e,n){},570:function(t,e,n){"use strict";n.r(e);var a=n(8),r=n(9),i=n(23),s=n(20),o=n(21),u=n(0),c=n(1),l=(n(273),n(105)),h=n(13),f=n(561),d=n(575),p=n(122),m=n(155),b=n(95),g=n(3),k=function(t){Object(s.a)(n,t);var e=Object(o.a)(n);function n(t){var r;return Object(a.a)(this,n),(r=e.call(this,t)).state={submitBusy:!1,email:"",password:"",error:null},r.login=r.login.bind(Object(i.a)(r)),r.loginWithMetamask=r.loginWithMetamask.bind(Object(i.a)(r)),r.goToMain=r.goToMain.bind(Object(i.a)(r)),r.handleSubmitLogin=r.handleSubmitLogin.bind(Object(i.a)(r)),r.handleSubmitLoginWithMetamask=r.handleSubmitLoginWithMetamask.bind(Object(i.a)(r)),r.handleEmailChange=r.handleEmailChange.bind(Object(i.a)(r)),r.handlePasswordChange=r.handlePasswordChange.bind(Object(i.a)(r)),r}return Object(r.a)(n,[{key:"login",value:function(t,e){var a=this;n.inputsAreValid(t,e)?(this.setState({submitBusy:!0,error:null}),l.a.auth.login({email:t,password:e}).then((function(t){a.setState({submitBusy:!1}),h.a.storeSession(t.token),a.props.history.push("/home")}),(function(t){a.setState({submitBusy:!1,error:t.error})}))):this.setState({error:"Please correct invalid fields."})}},{key:"loginWithMetamask",value:function(t,e){var n=this;this.setState({submitBusy:!0,error:null}),l.a.auth.quickLogin.ethLogin({publicAddress:t,signature:e}).then((function(t){n.setState({submitBusy:!1}),h.a.storeSession(t.token),n.props.history.push("/home")}),(function(t){n.setState({submitBusy:!1,error:t.error})}))}},{key:"handleSubmitLogin",value:function(t){t.preventDefault(),this.login(this.state.email,this.state.password)}},{key:"handleSubmitLoginWithMetamask",value:function(){var t=this,e=b.a.getDefaultAccount();null!=e?l.a.auth.quickLogin.ethGetNonce({publicAddress:e}).then((function(n){b.a.sign(e,n.nonce).then((function(n){console.log("signature:",n),t.loginWithMetamask(e,n)}),(function(e){t.setState({submitBusy:!1,error:e.error})}))}),(function(e){t.setState({submitBusy:!1,error:e.error})})):this.setState({error:"Select an account on your Metamask."})}},{key:"handleEmailChange",value:function(t){this.setState({email:t.target.value})}},{key:"handlePasswordChange",value:function(t){this.setState({password:t.target.value})}},{key:"goToMain",value:function(t){t.preventDefault(),this.props.history.push("/")}},{key:"render",value:function(){return Object(g.jsx)("div",{className:"content login",children:Object(g.jsxs)("div",{className:"wrapper",children:[Object(g.jsx)("div",{className:"exit-btn",children:Object(g.jsx)(f.a,{onClick:this.goToMain})}),Object(g.jsxs)("form",{onSubmit:this.handleSubmitLogin,children:[Object(g.jsx)("h3",{children:"Sign In"}),null!=this.state.error&&Object(g.jsx)(d.a,{variant:"danger",children:this.state.error}),Object(g.jsxs)("div",{className:"form-group",children:[Object(g.jsx)("label",{children:"Email address"}),Object(g.jsx)("input",{type:"email",value:this.state.email,onChange:this.handleEmailChange,className:"form-control",placeholder:"Enter email"})]}),Object(g.jsxs)("div",{className:"form-group",children:[Object(g.jsx)("label",{children:"Password"}),Object(g.jsx)("input",{type:"password",value:this.state.password,onChange:this.handlePasswordChange,className:"form-control",placeholder:"Enter password"})]}),Object(g.jsxs)(p.a,{type:"submit",className:"btn btn-primary btn-block",disabled:this.state.submitBusy,children:[this.state.submitBusy&&Object(g.jsx)("i",{className:"fa fa-refresh fa-spin",style:{marginRight:"5px"}}),this.state.submitBusy&&Object(g.jsx)("span",{children:"Logging-in.."}),!this.state.submitBusy&&Object(g.jsx)("span",{children:"Submit"})]}),Object(g.jsxs)("p",{className:"forgot-password text-right",children:["Forgot ",Object(g.jsx)("a",{href:"/#",children:"password?"})]})]}),Object(g.jsxs)("div",{className:"form-metamask",children:[Object(g.jsx)("div",{children:Object(g.jsx)("p",{className:"separator"})}),Object(g.jsx)(m.a,{text:"Login with Metamask",callback:this.handleSubmitLoginWithMetamask})]})]})})}}],[{key:"inputsAreValid",value:function(t,e){return""!==t&&""!==e}}]),n}(u.Component);e.default=Object(c.g)(k)},95:function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var a=n(106),r=n(8),i=n(9),s=n(69),o=n.n(s),u=n(157),c=n.n(u),l=n(266),h=n.n(l),f=function(){function t(){Object(r.a)(this,t)}return Object(i.a)(t,null,[{key:"loadMetamask",value:function(){var t=Object(a.a)(o.a.mark((function t(){var e;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.ethereum){t.next=10;break}return t.next=3,window.ethereum.request({method:"eth_requestAccounts"});case 3:return e=t.sent,window.web3=new c.a(window.ethereum),window.ethereum.defaultAccount=e[0],window.ethereum.on("accountsChanged",(function(t){window.ethereum.defaultAccount=t[0]})),t.abrupt("return",!0);case 10:return window.alert("Non-Ethereum browser detected. You should consider trying MetaMask!"),t.abrupt("return",!1);case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"isMetamaskInstalled",value:function(){var t=Object(a.a)(o.a.mark((function t(){var e;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h()();case 2:return e=t.sent,t.abrupt("return",!!e);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"isMetamaskConnected",value:function(){var t=Object(a.a)(o.a.mark((function t(){var e;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h()();case 2:if(!t.sent){t.next=11;break}return console.log("Metamask successfully detected!"),t.next=7,window.ethereum.request({method:"eth_accounts"});case 7:return e=t.sent,t.abrupt("return",e.length>0);case 11:return console.log("Metamask is not installed!"),t.abrupt("return",!1);case 13:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"sign",value:function(){var t=Object(a.a)(o.a.mark((function t(e,n){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a="Signing with Metamask: ".concat(n),t.next=3,window.ethereum.personal.sign(window.ethereum.fromUtf8(a),e,"");case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"getEth",value:function(){return window.ethereum}},{key:"getNetwork",value:function(){var t=Object(a.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("get network"),t.abrupt("return",window.web3.eth.net.getId());case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"getAccounts",value:function(){var t=Object(a.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,window.ethereum.request({method:"eth_accounts"});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"getDefaultAccount",value:function(){try{return window.ethereum.defaultAccount.toLowerCase()}catch(t){return null}}},{key:"address",value:function(t){return t.toLowerCase()}},{key:"isDefaultAccount",value:function(t){return this.getDefaultAccount()===t.toLowerCase()}},{key:"encode",value:function(t){return window.web3.utils.fromAscii(t)}},{key:"nullAddress",value:function(){return"0x0000000000000000000000000000000000000000"}},{key:"nullBytes",value:function(){return"0x0000000000000000000000000000000000000000000000000000000000000000"}}]),t}()}}]);
//# sourceMappingURL=4.c1f14894.chunk.js.map