{"version":3,"sources":["utils/http/HttpUtils.ts","api/ApiEndpoint.ts","api/ApiSDK.ts","resources/images.ts","resources/icons/metamask.png","web/auth/components/MetamaskButton.tsx","web/auth/views/login/LoginView.tsx","blockchain/Web3SDK.ts"],"names":["ApiError","HttpUtils","parameters","result","i","domain","endpoint","urlParameters","slice","response","onSuccess","onError","console","log","redirected","status","error","type","UNAUTHORIZED","text","then","success","JSON","parse","data","SERVER_ERROR","headers","SessionStorage","hasSession","token","getSessionToken","this","stringifyParameters","url","createUrl","fetch","method","handleHttpResult","catch","stringify","OTHER","body","httpURL","httpData","ApiEndpoint","process","REACT_APP_API_ENDPOINT","ApiSDK","auth","login","request","Promise","resolve","reject","post","quickLogin","ethLogin","ethGetNonce","get","signup","signupWithEth","user","IconImg","MetamaskButton","props","onClick","bind","e","a","Web3SDK","isMetamaskConnected","loadMetamask","callback","Button","className","Image","src","Component","LoginView","state","submitBusy","email","password","loginWithMetamask","goToMain","handleSubmitLogin","handleSubmitLoginWithMetamask","handleEmailChange","handlePasswordChange","inputsAreValid","setState","r","storeSession","history","push","publicAddress","signature","preventDefault","getDefaultAccount","sign","nonce","target","value","onSubmit","variant","onChange","placeholder","disabled","style","marginRight","href","withRouter","window","ethereum","accounts","web3","Web3","defaultAccount","on","alert","detectEthereumProvider","provider","length","message","personal","fromUtf8","eth","net","getId","toLowerCase","address","utils","fromAscii"],"mappings":"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","file":"static/js/4.c1f14894.chunk.js","sourcesContent":["import SessionStorage from '../storage/UserStorage'\n\nexport interface SuccessResponse<T> {\n    data: T\n}\nexport interface ErrorResponse {\n    data: { error: string }\n}\n\nexport enum ApiError {\n    UNAUTHORIZED,\n    SERVER_ERROR,\n    OTHER\n}\n\nexport interface ErrorDTO {\n    type: ApiError\n    error: string\n}\n\nexport default class HttpUtils {\n\n    private static stringifyParameters(parameters: { [key: string]: string } | null): string {\n        if (parameters == null) {\n            return ''\n        }\n        let result = ''\n        for (let i in parameters) {\n            if (result !== '')\n                result += '&'\n            result += `${i}=${parameters[i]}`\n        }\n        result = (result === '' ? result : '?' + result)\n        return result\n    }\n\n    private static createUrl(domain: string | null, endpoint: string, urlParameters: string | null): string {\n        if (domain != null && domain.slice(-1) !== '/') {\n            domain += '/'\n        }\n        return (domain || '') + endpoint + (urlParameters || '')\n    }\n\n    private static handleHttpResult<T>(\n        response: Response,\n        onSuccess: (data: T) => void,\n        onError: (error: ErrorDTO) => void) {\n        console.log('[HTTP]', response);\n        if (response.redirected || response.status === 302) {\n            console.log('[HTTP] redirection');\n        }\n        if (response.status === 401) {\n            console.log('[HTTP] need login');\n            onError({\n                error: \"Unauthorized access.\",\n                type: ApiError.UNAUTHORIZED\n            });\n        } else {\n            response.text().then(function (text) {\n                const status = response.status;\n                if (status === 200) {\n                    const success: SuccessResponse<T> = JSON.parse(text)\n                    onSuccess(success.data);\n                } else {\n                    const error: ErrorResponse = JSON.parse(text)\n                    onError({\n                        error: error.data.error,\n                        type: ApiError.SERVER_ERROR\n                    });\n                }\n            });\n        }\n    }\n\n    private static httpURL<T>(\n        type: string,\n        domain: string | null,\n        endpoint: string,\n        headers: { [key: string]: string },\n        parameters: { [key: string]: string } | null,\n        onSuccess: (data: T) => void,\n        onError: (error: ErrorDTO) => void) {\n\n        if (SessionStorage.hasSession()) {\n            let token = SessionStorage.getSessionToken()\n            if (token)\n                headers['Authorization'] = token\n        }\n        let urlParameters: string = this.stringifyParameters(parameters)\n        let url: string = this.createUrl(domain, endpoint, urlParameters)\n        console.log('[API_' + type + ']: ' + url)\n\n        fetch(url, {\n            method: type,\n            headers: headers\n        }).then(response => {\n            this.handleHttpResult(response, onSuccess, onError)\n        }).catch(error => {\n            console.log('[API][ERROR]-->', error)\n            onError({\n                error: JSON.stringify(error.error),\n                type: ApiError.OTHER\n            });\n        })\n    }\n\n    private static httpData<T>(\n        type: string,\n        domain: string | null,\n        endpoint: string,\n        headers: { [key: string]: string },\n        data: BodyInit,\n        onSuccess: (data: T) => void,\n        onError: (error: ErrorDTO) => void) {\n\n        if (SessionStorage.hasSession()) {\n            let token = SessionStorage.getSessionToken()\n            if (token)\n                headers['Authorization'] = token\n        }\n        let url: string = this.createUrl(domain, endpoint, null)\n\n        console.log('[API_' + type + ']: ' + url)\n        fetch(url, {\n            method: type,\n            headers: headers,\n            body: data\n        }).then(response => {\n            this.handleHttpResult(response, onSuccess, onError)\n        }).catch(error => {\n            console.log('[API][ERROR]-->', error)\n            onError({\n                error: error.error,\n                type: ApiError.OTHER\n            });\n        })\n    }\n\n    static get<T>(domain: string | null, endpoint: string, parameters: { [key: string]: string } | null, onSuccess: (data: T) => void, onError: (error: ErrorDTO) => void) {\n        let headers: { [key: string]: string } = {}\n        headers['Access-Control-Allow-Origin'] = '*'\n        this.httpURL('GET', domain, endpoint, headers, parameters, onSuccess, onError)\n    }\n\n    static post<T>(domain: string | null, endpoint: string, data: {}, onSuccess: (data: T) => void, onError: (error: ErrorDTO) => void) {\n        let headers: { [key: string]: string } = {}\n        headers['Content-Type'] = 'application/json'\n        headers['Accept'] = 'application/json'\n        this.httpData('POST', domain, endpoint, headers, JSON.stringify(data), onSuccess, onError)\n    }\n\n    static put<T>(domain: string | null, endpoint: string, data: {}, onSuccess: (data: T) => void, onError: (error: ErrorDTO) => void) {\n        let headers: { [key: string]: string } = {}\n        headers['Content-Type'] = 'application/json'\n        headers['Accept'] = 'application/json'\n        this.httpData('PUT', domain, endpoint, headers, JSON.stringify(data), onSuccess, onError)\n    }\n\n    static delete<T>(domain: string | null, endpoint: string, data: {}, onSuccess: (data: T) => void, onError: (error: ErrorDTO) => void) {\n        let headers: { [key: string]: string } = {}\n        headers['Content-Type'] = 'application/json'\n        headers['Accept'] = 'application/json'\n        this.httpData('DELETE', domain, endpoint, headers, JSON.stringify(data), onSuccess, onError)\n    }\n}","export const ApiEndpoint = {\n    AUTH_Login: 'api/auth/login',\n    AUTH_Login_eth: 'api/auth/login/quick-login/eth',\n    AUTH_Login_eth_getNonce: 'api/auth/login/quick-login/eth/get-nonce',\n    AUTH_Signup: 'api/auth/signup',\n    AUTH_Signup_eth: 'api/auth/signup/eth-linked',\n    USER_get: 'api/user/get',\n}","import {UserApi} from \"./user/UserApi\";\nimport {AuthApi} from \"./auth/AuthApi\";\nimport {UserDTO} from \"./user/UserDTO\";\nimport HttpUtils from \"../utils/http/HttpUtils\";\nimport {ApiEndpoint} from \"./ApiEndpoint\";\nimport {TokenDTO} from \"./auth/TokenDTO\";\nimport {LoginRequest} from \"./auth/LoginRequest\";\nimport {SignupRequest} from \"./auth/SignupRequest\";\nimport {SignupEthRequest} from \"./auth/SignupEthRequest\";\nimport {EthLoginRequest} from \"./auth/EthLoginRequest\";\nimport {GetNonceRequest} from \"./auth/GetNonceRequest\";\nimport {NonceDTO} from \"./auth/NonceDTO\";\n\nconst domain: string | null = process.env.REACT_APP_API_ENDPOINT || null;\n\nexport default class ApiSDK {\n\n    static auth: AuthApi = {\n        login: function (request: LoginRequest): Promise<TokenDTO> {\n            return new Promise<TokenDTO>(function (resolve, reject) {\n                HttpUtils.post(domain, ApiEndpoint.AUTH_Login, request, resolve, reject);\n            });\n        },\n        quickLogin: {\n            ethLogin: function (request: EthLoginRequest): Promise<TokenDTO> {\n                return new Promise<TokenDTO>(function (resolve, reject) {\n                    HttpUtils.post(domain, ApiEndpoint.AUTH_Login_eth, request, resolve, reject);\n                });\n            },\n            ethGetNonce: function (request: GetNonceRequest): Promise<NonceDTO> {\n                return new Promise<NonceDTO>(function (resolve, reject) {\n                    HttpUtils.get(domain, ApiEndpoint.AUTH_Login_eth_getNonce, request, resolve, reject);\n                });\n            }\n        },\n        signup: function (request: SignupRequest): Promise<UserDTO> {\n            return new Promise<UserDTO>(function (resolve, reject) {\n                HttpUtils.post(domain, ApiEndpoint.AUTH_Signup, request, resolve, reject);\n            });\n        },\n        signupWithEth: function (request: SignupEthRequest): Promise<UserDTO> {\n            return new Promise<UserDTO>(function (resolve, reject) {\n                HttpUtils.post(domain, ApiEndpoint.AUTH_Signup_eth, request, resolve, reject);\n            });\n        }\n    }\n\n    static user: UserApi = {\n        get: function (): Promise<UserDTO> {\n            return new Promise<UserDTO>(function (resolve, reject) {\n                HttpUtils.get(domain, ApiEndpoint.USER_get, null, resolve, reject);\n            });\n        }\n    }\n}","import metamask from './icons/metamask.png'\n\nexport const IconImg = {\n    METAMASK: metamask\n}","export default \"data:image/png;base64,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\"","import {Component} from \"react\";\nimport {Button, Image} from \"react-bootstrap\";\nimport {IconImg} from \"../../../resources/images\";\n\nimport './MetamaskButton.scss';\nimport Web3SDK from \"../../../blockchain/Web3SDK\";\n\ninterface MetamaskButtonProperties {\n    text: string,\n    callback: () => void\n}\n\ntype MetamaskButtonState = {}\n\nexport default class MetamaskButton extends Component<MetamaskButtonProperties, MetamaskButtonState> {\n    constructor(props: MetamaskButtonProperties) {\n        super(props)\n        this.onClick = this.onClick.bind(this)\n    }\n\n    async onClick(e: any) {\n        const walletConnected = await Web3SDK.isMetamaskConnected()\n        if (walletConnected) {\n            Web3SDK.loadMetamask().then(() => {\n                this.props.callback()\n            })\n        }\n    }\n\n    render() {\n        return <Button className=\"metamask-btn\" onClick={this.onClick}><Image className=\"metamask-icon\" src={IconImg.METAMASK}/>\n            <span className=\"metamask-btn-text\">{this.props.text}</span>\n        </Button>\n    }\n}","import {Component} from \"react\";\nimport {RouteComponentProps, withRouter} from \"react-router-dom\";\nimport './LoginView.scss';\nimport ApiSDK from \"../../../../api/ApiSDK\";\nimport SessionStorage from \"../../../../utils/storage/UserStorage\";\nimport {Alert, Button, CloseButton} from \"react-bootstrap\";\nimport MetamaskButton from \"../../components/MetamaskButton\";\nimport Web3SDK from \"../../../../blockchain/Web3SDK\";\n\ninterface LoginViewProperties extends RouteComponentProps {\n}\n\ntype LoginViewState = {\n    submitBusy: boolean,\n    email: string,\n    password: string,\n    error: string | null\n}\n\nclass LoginView extends Component<LoginViewProperties, LoginViewState> {\n\n    constructor(props: LoginViewProperties) {\n        super(props)\n        this.state = {\n            submitBusy: false,\n            email: '',\n            password: '',\n            error: null\n        }\n        this.login = this.login.bind(this)\n        this.loginWithMetamask = this.loginWithMetamask.bind(this)\n        this.goToMain = this.goToMain.bind(this)\n        this.handleSubmitLogin = this.handleSubmitLogin.bind(this)\n        this.handleSubmitLoginWithMetamask = this.handleSubmitLoginWithMetamask.bind(this)\n        this.handleEmailChange = this.handleEmailChange.bind(this)\n        this.handlePasswordChange = this.handlePasswordChange.bind(this)\n    }\n\n    private static inputsAreValid(email: string, password: string): boolean {\n        return email !== '' && password !== ''\n    }\n\n    private login(email: string, password: string) {\n        if (!LoginView.inputsAreValid(email, password)) {\n            // TODO detailed errors per fields\n            this.setState({error: \"Please correct invalid fields.\"})\n            return\n        }\n        this.setState({submitBusy: true, error: null})\n        ApiSDK.auth.login({email: email, password: password}).then(r => {\n            this.setState({submitBusy: false})\n            SessionStorage.storeSession(r.token)\n            this.props.history.push('/home')\n        }, e => {\n            this.setState({submitBusy: false, error: e.error})\n        })\n    }\n\n    private loginWithMetamask(publicAddress: string, signature: string) {\n        this.setState({submitBusy: true, error: null})\n        ApiSDK.auth.quickLogin.ethLogin({publicAddress: publicAddress, signature: signature}).then(r => {\n            this.setState({submitBusy: false})\n            SessionStorage.storeSession(r.token)\n            this.props.history.push('/home')\n        }, e => {\n            this.setState({submitBusy: false, error: e.error})\n        })\n    }\n\n    handleSubmitLogin(e: any) {\n        e.preventDefault();\n        this.login(this.state.email, this.state.password)\n    }\n\n    handleSubmitLoginWithMetamask() {\n        const publicAddress = Web3SDK.getDefaultAccount()\n        if (publicAddress == null) {\n            this.setState({error: \"Select an account on your Metamask.\"})\n            return\n        }\n        ApiSDK.auth.quickLogin.ethGetNonce({publicAddress: publicAddress}).then(r => {\n            Web3SDK.sign(publicAddress, r.nonce).then(signature => {\n                console.log('signature:', signature)\n                this.loginWithMetamask(publicAddress, signature)\n            }, e => {\n                this.setState({submitBusy: false, error: e.error})\n            })\n        }, e => {\n            this.setState({submitBusy: false, error: e.error})\n        })\n    }\n\n    handleEmailChange(e: any) {\n        this.setState({email: e.target.value})\n    }\n\n    handlePasswordChange(e: any) {\n        this.setState({password: e.target.value})\n    }\n\n    goToMain(e: any) {\n        e.preventDefault();\n        this.props.history.push('/')\n    }\n\n    render() {\n        return <div className=\"content login\">\n            <div className=\"wrapper\">\n                <div className=\"exit-btn\">\n                    <CloseButton onClick={this.goToMain}/>\n                </div>\n                <form onSubmit={this.handleSubmitLogin}>\n                    <h3>Sign In</h3>\n                    {this.state.error != null && <Alert variant={'danger'}>{this.state.error}</Alert>}\n                    <div className=\"form-group\">\n                        <label>Email address</label>\n                        <input type=\"email\" value={this.state.email} onChange={this.handleEmailChange}\n                               className=\"form-control\" placeholder=\"Enter email\"/>\n                    </div>\n                    <div className=\"form-group\">\n                        <label>Password</label>\n                        <input type=\"password\" value={this.state.password} onChange={this.handlePasswordChange}\n                               className=\"form-control\" placeholder=\"Enter password\"/>\n                    </div>\n                    <Button type=\"submit\" className=\"btn btn-primary btn-block\" disabled={this.state.submitBusy}>\n                        {this.state.submitBusy &&\n                            <i className=\"fa fa-refresh fa-spin\" style={{marginRight: \"5px\"}}/>}\n                        {this.state.submitBusy && <span>Logging-in..</span>}\n                        {!this.state.submitBusy && <span>Submit</span>}\n                    </Button>\n                    <p className=\"forgot-password text-right\">\n                        Forgot <a href=\"/#\">password?</a>\n                    </p>\n                </form>\n                <div className=\"form-metamask\">\n                    <div><p className=\"separator\"/></div>\n                    <MetamaskButton text={\"Login with Metamask\"} callback={this.handleSubmitLoginWithMetamask}/>\n                </div>\n            </div>\n        </div>\n    }\n}\n\nexport default withRouter(LoginView);","import Web3 from 'web3'\nimport detectEthereumProvider from '@metamask/detect-provider';\nimport {Address} from \"./types\";\n\ndeclare let window: any;\n\nexport default class Web3SDK {\n\n    static async loadMetamask(): Promise<boolean> {\n        if (window.ethereum) {\n            const accounts = await window.ethereum.request({method: 'eth_requestAccounts'})\n            window.web3 = new Web3(window.ethereum)\n            window.ethereum.defaultAccount = accounts[0]\n            window.ethereum.on('accountsChanged', (accounts: string[]) => {\n                window.ethereum.defaultAccount = accounts[0]\n            })\n            return true\n        }\n            // else if (window.web3) {\n            //     window.web3 = new Web3(window.web3.currentProvider)\n            //     return true\n        // }\n        else {\n            window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!')\n            return false\n        }\n    }\n\n    static async isMetamaskInstalled(): Promise<boolean> {\n        const provider = await detectEthereumProvider();\n        return !!provider;\n    }\n\n    static async isMetamaskConnected(): Promise<boolean> {\n        const provider = await detectEthereumProvider()\n\n        if (provider) {\n            console.log('Metamask successfully detected!');\n            const result = await window.ethereum.request({method: 'eth_accounts'})\n            return result.length > 0\n        } else {\n            console.log('Metamask is not installed!');\n            return false\n        }\n    }\n\n    static async sign(publicAddress: string, text: string): Promise<string> {\n        const message = `Signing with Metamask: ${text}`\n        return await window.ethereum.personal.sign(window.ethereum.fromUtf8(message), publicAddress, '')\n    }\n\n    // @ts-ignore\n    static getEth(): EthereumProvider | null {\n        return window.ethereum\n    }\n\n    static async getNetwork(): Promise<bigint> {\n        console.log(\"get network\")\n        return window.web3.eth.net.getId()\n    }\n\n    static async getAccounts(): Promise<Address[]> {\n        return await window.ethereum.request({method: 'eth_accounts'})\n    }\n\n    static getDefaultAccount(): Address | null {\n        try {\n            return window.ethereum.defaultAccount.toLowerCase()\n        } catch (e) {\n            return null\n        }\n    }\n\n    static address(value: Address): Address {\n        return value.toLowerCase()\n    }\n\n    static isDefaultAccount(address: Address): boolean {\n        return this.getDefaultAccount() === address.toLowerCase()\n    }\n\n    static encode(value: string): string {\n        return window.web3.utils.fromAscii(value)\n    }\n\n    static nullAddress() {\n        return '0x0000000000000000000000000000000000000000';\n    }\n\n    static nullBytes() {\n        return '0x0000000000000000000000000000000000000000000000000000000000000000';\n    }\n}"],"sourceRoot":""}