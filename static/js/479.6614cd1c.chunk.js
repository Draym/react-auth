"use strict";(self.webpackChunkreact_auth=self.webpackChunkreact_auth||[]).push([[479],{692:function(t,e,n){n.d(e,{Z:function(){return p}});var a,s=n(3144),r=n(5671),i=n(717);!function(t){t[t.UNAUTHORIZED=0]="UNAUTHORIZED",t[t.SERVER_ERROR=1]="SERVER_ERROR",t[t.OTHER=2]="OTHER"}(a||(a={}));var o=function(){function t(){(0,r.Z)(this,t)}return(0,s.Z)(t,null,[{key:"stringifyParameters",value:function(t){if(null==t)return"";var e="";for(var n in t)""!==e&&(e+="&"),e+="".concat(n,"=").concat(t[n]);return e=""===e?e:"?"+e}},{key:"createUrl",value:function(t,e,n){return null!=t&&"/"!==t.slice(-1)&&(t+="/"),(t||"")+e+(n||"")}},{key:"handleHttpResult",value:function(t,e,n){console.log("[HTTP]",t),(t.redirected||302===t.status)&&console.log("[HTTP] redirection"),401===t.status?(console.log("[HTTP] need login"),n({error:"Unauthorized access.",type:a.UNAUTHORIZED})):t.text().then((function(s){if(200===t.status){var r=JSON.parse(s);e(r.data)}else{var i=JSON.parse(s);n({error:i.data.error,type:a.SERVER_ERROR})}}))}},{key:"httpURL",value:function(t,e,n,s,r,o,u){var l=this;if(i.Z.hasSession()){var c=i.Z.getSessionToken();c&&(s.Authorization=c)}var h=this.stringifyParameters(r),p=this.createUrl(e,n,h);console.log("[API_"+t+"]: "+p),fetch(p,{method:t,headers:s}).then((function(t){l.handleHttpResult(t,o,u)})).catch((function(t){console.log("[API][ERROR]--\x3e",t),u({error:JSON.stringify(t.error),type:a.OTHER})}))}},{key:"httpData",value:function(t,e,n,s,r,o,u){var l=this;if(i.Z.hasSession()){var c=i.Z.getSessionToken();c&&(s.Authorization=c)}var h=this.createUrl(e,n,null);console.log("[API_"+t+"]: "+h),fetch(h,{method:t,headers:s,body:r}).then((function(t){l.handleHttpResult(t,o,u)})).catch((function(t){console.log("[API][ERROR]--\x3e",t),u({error:t.error,type:a.OTHER})}))}},{key:"get",value:function(t,e,n,a,s){var r={"Access-Control-Allow-Origin":"*"};this.httpURL("GET",t,e,r,n,a,s)}},{key:"post",value:function(t,e,n,a,s){var r={"Content-Type":"application/json",Accept:"application/json"};this.httpData("POST",t,e,r,JSON.stringify(n),a,s)}},{key:"put",value:function(t,e,n,a,s){var r={"Content-Type":"application/json",Accept:"application/json"};this.httpData("PUT",t,e,r,JSON.stringify(n),a,s)}},{key:"delete",value:function(t,e,n,a,s){var r={"Content-Type":"application/json",Accept:"application/json"};this.httpData("DELETE",t,e,r,JSON.stringify(n),a,s)}}]),t}(),u="api/auth/login",l="api/auth/signup",c="api/user/get",h={NODE_ENV:"production",PUBLIC_URL:"/react-auth",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_ENDPOINT||null,p=(0,s.Z)((function t(){(0,r.Z)(this,t)}));p.auth={login:function(t){return new Promise((function(e,n){o.post(h,u,t,e,n)}))},signup:function(t){return new Promise((function(e,n){o.post(h,l,t,e,n)}))}},p.user={get:function(){return new Promise((function(t,e){o.get(h,c,null,t,e)}))}}},3479:function(t,e,n){n.r(e),n.d(e,{default:function(){return R}});var a=n(5861),s=n(5671),r=n(3144),i=n(7326),o=n(136),u=n(8347),l=n(7757),c=n.n(l),h=n(2791),p=n(9271),d=n(692),f=n(717),g=n(473),m=n(4784),v=n(3360),y=n(184),E=function(t){(0,o.Z)(n,t);var e=(0,u.Z)(n);function n(t){var r;return(0,s.Z)(this,n),(r=e.call(this,t)).login=function(t,e){r.setState({submitBusy:!0,error:null}),d.Z.auth.login({email:t,password:e}).then((function(t){r.setState({submitBusy:!1}),f.Z.storeSession(t.token),r.props.history.push("/home")}),(function(t){r.setState({submitBusy:!1,error:t.error})}))},r.handleSubmit=function(){var t=(0,a.Z)(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.preventDefault(),r.login(r.state.email,r.state.password);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),r.handleEmailChange=function(){var t=(0,a.Z)(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r.setState({email:e.target.value});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),r.handlePasswordChange=function(){var t=(0,a.Z)(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r.setState({password:e.target.value});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),r.goToMain=function(t){t.preventDefault(),r.props.history.push("/")},r.state={submitBusy:!1,email:"",password:"",error:null},r.login=r.login.bind((0,i.Z)(r)),r.goToMain=r.goToMain.bind((0,i.Z)(r)),r.handleSubmit=r.handleSubmit.bind((0,i.Z)(r)),r.handleEmailChange=r.handleEmailChange.bind((0,i.Z)(r)),r.handlePasswordChange=r.handlePasswordChange.bind((0,i.Z)(r)),r}return(0,r.Z)(n,[{key:"render",value:function(){return(0,y.jsx)("div",{className:"content login",children:(0,y.jsxs)("div",{className:"wrapper",children:[(0,y.jsx)("div",{className:"exit-btn",children:(0,y.jsx)(g.Z,{onClick:this.goToMain})}),(0,y.jsxs)("form",{onSubmit:this.handleSubmit,children:[(0,y.jsx)("h3",{children:"Sign In"}),null!=this.state.error&&(0,y.jsx)(m.Z,{variant:"danger",children:this.state.error}),(0,y.jsxs)("div",{className:"form-group",children:[(0,y.jsx)("label",{children:"Email address"}),(0,y.jsx)("input",{type:"email",value:this.state.email,onChange:this.handleEmailChange,className:"form-control",placeholder:"Enter email"})]}),(0,y.jsxs)("div",{className:"form-group",children:[(0,y.jsx)("label",{children:"Password"}),(0,y.jsx)("input",{type:"password",value:this.state.password,onChange:this.handlePasswordChange,className:"form-control",placeholder:"Enter password"})]}),(0,y.jsxs)(v.Z,{type:"submit",className:"btn btn-primary btn-block",disabled:this.state.submitBusy,children:[this.state.submitBusy&&(0,y.jsx)("i",{className:"fa fa-refresh fa-spin",style:{marginRight:"5px"}}),this.state.submitBusy&&(0,y.jsx)("span",{children:"Logging-in.."}),!this.state.submitBusy&&(0,y.jsx)("span",{children:"Submit"})]}),(0,y.jsxs)("p",{className:"forgot-password text-right",children:["Forgot ",(0,y.jsx)("a",{href:"/#",children:"password?"})]})]})]})})}}]),n}(h.Component),R=(0,p.EN)(E)}}]);
//# sourceMappingURL=479.6614cd1c.chunk.js.map