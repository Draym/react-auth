"use strict";(self.webpackChunkreact_auth=self.webpackChunkreact_auth||[]).push([[907],{692:function(e,t,n){n.d(t,{Z:function(){return p}});var r,s=n(3144),a=n(5671),i=n(717);!function(e){e[e.UNAUTHORIZED=0]="UNAUTHORIZED",e[e.SERVER_ERROR=1]="SERVER_ERROR",e[e.OTHER=2]="OTHER"}(r||(r={}));var o=function(){function e(){(0,a.Z)(this,e)}return(0,s.Z)(e,null,[{key:"stringifyParameters",value:function(e){if(null==e)return"";var t="";for(var n in e)""!==t&&(t+="&"),t+="".concat(n,"=").concat(e[n]);return t=""===t?t:"?"+t}},{key:"createUrl",value:function(e,t,n){return null!=e&&"/"!==e.slice(-1)&&(e+="/"),(e||"")+t+(n||"")}},{key:"handleHttpResult",value:function(e,t,n){console.log("[HTTP]",e),(e.redirected||302===e.status)&&console.log("[HTTP] redirection"),401===e.status?(console.log("[HTTP] need login"),n({error:"Unauthorized access.",type:r.UNAUTHORIZED})):e.text().then((function(s){if(200===e.status){var a=JSON.parse(s);t(a.data)}else{var i=JSON.parse(s);n({error:i.data.error,type:r.SERVER_ERROR})}}))}},{key:"httpURL",value:function(e,t,n,s,a,o,u){var l=this;if(i.Z.hasSession()){var c=i.Z.getSessionToken();c&&(s.Authorization=c)}var h=this.stringifyParameters(a),p=this.createUrl(t,n,h);console.log("[API_"+e+"]: "+p),fetch(p,{method:e,headers:s}).then((function(e){l.handleHttpResult(e,o,u)})).catch((function(e){console.log("[API][ERROR]--\x3e",e),u({error:JSON.stringify(e.error),type:r.OTHER})}))}},{key:"httpData",value:function(e,t,n,s,a,o,u){var l=this;if(i.Z.hasSession()){var c=i.Z.getSessionToken();c&&(s.Authorization=c)}var h=this.createUrl(t,n,null);console.log("[API_"+e+"]: "+h),fetch(h,{method:e,headers:s,body:a}).then((function(e){l.handleHttpResult(e,o,u)})).catch((function(e){console.log("[API][ERROR]--\x3e",e),u({error:e.error,type:r.OTHER})}))}},{key:"get",value:function(e,t,n,r,s){var a={"Access-Control-Allow-Origin":"*"};this.httpURL("GET",e,t,a,n,r,s)}},{key:"post",value:function(e,t,n,r,s){var a={"Content-Type":"application/json",Accept:"application/json"};this.httpData("POST",e,t,a,JSON.stringify(n),r,s)}},{key:"put",value:function(e,t,n,r,s){var a={"Content-Type":"application/json",Accept:"application/json"};this.httpData("PUT",e,t,a,JSON.stringify(n),r,s)}},{key:"delete",value:function(e,t,n,r,s){var a={"Content-Type":"application/json",Accept:"application/json"};this.httpData("DELETE",e,t,a,JSON.stringify(n),r,s)}}]),e}(),u="api/auth/login",l="api/auth/signup",c="api/user/get",h={NODE_ENV:"production",PUBLIC_URL:"/react-auth",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_ENDPOINT||null,p=(0,s.Z)((function e(){(0,a.Z)(this,e)}));p.auth={login:function(e){return new Promise((function(t,n){o.post(h,u,e,t,n)}))},signup:function(e){return new Promise((function(t,n){o.post(h,l,e,t,n)}))}},p.user={get:function(){return new Promise((function(e,t){o.get(h,c,null,e,t)}))}}},6907:function(e,t,n){n.r(t),n.d(t,{default:function(){return R}});var r=n(5861),s=n(5671),a=n(3144),i=n(7326),o=n(136),u=n(8347),l=n(7757),c=n.n(l),h=n(2791),p=n(9271),d=n(473),f=n(4784),g=n(3360),m=n(692),v=n(717),y=n(184),E=function(e){(0,o.Z)(n,e);var t=(0,u.Z)(n);function n(e){var a;return(0,s.Z)(this,n),(a=t.call(this,e)).signup=function(e,t,n){a.setState({submitBusy:!0,error:null}),m.Z.auth.signup({email:e,username:t,password:n}).then((function(t){m.Z.auth.login({email:e,password:n}).then((function(e){a.setState({submitBusy:!1}),v.Z.storeSession(e.token),a.props.history.push("/home")}),(function(e){console.log("error",e),a.setState({submitBusy:!1,error:e.error})}))}),(function(e){console.log("error",e),a.setState({submitBusy:!1,error:e.error})}))},a.handleSubmit=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),a.signup(a.state.email,a.state.username,a.state.password);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleEmailChange=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({email:t.target.value});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleUsernameChange=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({username:t.target.value});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handlePasswordChange=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({password:t.target.value});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.goToLogin=function(e){e.preventDefault(),a.props.history.push("/login")},a.goToMain=function(e){e.preventDefault(),a.props.history.push("/")},a.state={submitBusy:!1,email:"",username:"",password:"",error:null},a.signup=a.signup.bind((0,i.Z)(a)),a.goToLogin=a.goToLogin.bind((0,i.Z)(a)),a.goToMain=a.goToMain.bind((0,i.Z)(a)),a.handleSubmit=a.handleSubmit.bind((0,i.Z)(a)),a.handleEmailChange=a.handleEmailChange.bind((0,i.Z)(a)),a.handleUsernameChange=a.handleUsernameChange.bind((0,i.Z)(a)),a.handlePasswordChange=a.handlePasswordChange.bind((0,i.Z)(a)),a}return(0,a.Z)(n,[{key:"render",value:function(){return(0,y.jsxs)("div",{className:"content signup",children:[(0,y.jsx)("div",{className:"exit-btn",children:(0,y.jsx)(d.Z,{onClick:this.goToMain})}),(0,y.jsx)("div",{className:"wrapper",children:(0,y.jsxs)("form",{onSubmit:this.handleSubmit,children:[(0,y.jsx)("h3",{children:"Register"}),null!=this.state.error&&(0,y.jsx)(f.Z,{variant:"danger",children:this.state.error}),(0,y.jsxs)("div",{className:"form-group",children:[(0,y.jsx)("label",{children:"Email address"}),(0,y.jsx)("input",{type:"email",value:this.state.email,onChange:this.handleEmailChange,className:"form-control",placeholder:"Enter email"})]}),(0,y.jsxs)("div",{className:"form-group",children:[(0,y.jsx)("label",{children:"Username"}),(0,y.jsx)("input",{type:"text",value:this.state.username,onChange:this.handleUsernameChange,className:"form-control",placeholder:"Enter username"})]}),(0,y.jsxs)("div",{className:"form-group",children:[(0,y.jsx)("label",{children:"Password"}),(0,y.jsx)("input",{type:"password",value:this.state.password,onChange:this.handlePasswordChange,className:"form-control",placeholder:"Enter password"})]}),(0,y.jsxs)(g.Z,{type:"submit",className:"btn btn-primary btn-block",disabled:this.state.submitBusy,children:[this.state.submitBusy&&(0,y.jsx)("i",{className:"fa fa-refresh fa-spin",style:{marginRight:"5px"}}),this.state.submitBusy&&(0,y.jsx)("span",{children:"Logging-in.."}),!this.state.submitBusy&&(0,y.jsx)("span",{children:"Submit"})]}),(0,y.jsxs)("p",{className:"is-registered text-right",children:["Already registered ",(0,y.jsx)("a",{href:"/#",onClick:this.goToLogin,children:"sign in?"})]})]})})]})}}]),n}(h.Component),R=(0,p.EN)(E)}}]);
//# sourceMappingURL=907.bb49047a.chunk.js.map